CREATE DATABASE MYDATABASE;
USE MYDATABASE;

/*
CREATE TABLE CUSTOMERS(
	CID INT NOT NULL AUTO_INCREMENT,
	CNAME VARCHAR(30) NOT NULL,
	CITY VARCHAR(30) NOT NULL,
	DOB DATE NOT NULL,
	PHONE BIGINT(12),
	PRIMARY KEY(CID)
);*/


INSERT INTO CUSTOMERS(CID,CNAME,CITY,DOB,PHONE) VALUES
(1,'GAURAV','RAJKOT','2001-05-16',8780478205),
(2,'JAY','GONDAL','2002-05-09',8780478201),
(3,'RUCHIT','RAJKOT','2003-02-11',8780478202),
(4,'HEMAL','AHMEDABAD','2004-09-03',8780478203),
(5,'MIHIR','GANDHINAGAR','1999-02-13',8780478204),
(6,'YASH','SURAT','2010-04-10',9000478206);

SELECT * FROM CUSTOMERS;
SELECT * FROM CUSTOMERS WHERE CITY = 'RAJKOT';
SELECT * FROM CUSTOMERS WHERE DOB < '2000-01-01';
SELECT * FROM CUSTOMERS WHERE CITY LIKE '%KOT';
SELECT * FROM CUSTOMERS WHERE CITY LIKE 'G%';
SELECT * FROM CUSTOMERS WHERE CITY LIKE '___A%';
SELECT * FROM CUSTOMERS WHERE CNAME NOT LIKE '_A%';
SELECT * FROM CUSTOMERS WHERE CITY NOT IN('RAJKOT','AHMEDABAD','SURAT');
SELECT DOB FROM CUSTOMERS WHERE CNAME IN('MIHIR','GAURAV');
SELECT CNAME,CITY,PHONE FROM CUSTOMERS WHERE (CNAME IN('MIHIR','GAURAV','YASH','JAY') AND CITY IN('RAJKOT','SURAT'));

/*
CREATE TABLE ORDERS(
	OID INT AUTO_INCREMENT NOT NULL,
    PNAME VARCHAR(40) NOT NULL,
    PRICE INT(6),
    CID INT NOT NULL,
	PRIMARY KEY(OID),
    FOREIGN KEY(CID) REFERENCES customers(CID)
)*/

INSERT INTO ORDERS (OID,PNAME,PRICE,CID)
VALUES(101,'LAPTOP',25000,1),
VALUES(102,'PENDRIVE',700,6),
VALUES(103,'EARBUDS',2500,4);

-- INNER JOIN
SELECT C.CID,C.CNAME,C.CITY,C.PHONE,O.OID,O.PNAME,O.PRICE FROM customers C
INNER JOIN ORDERS O
ON(C.cid=O.CID);
--LEFT JOIN
SELECT C.CID,CNAME,CITY,PHONE,OID,PNAME,PRICE FROM CUSTOMERS C
LEFT JOIN ORDERS O
ON (C.CID=O.CID);
--ALTER TABLE AND INSERT (SOLVED RIGHT JOIN ERROR)
ALTER TABLE ORDERS MODIFY COLUMN CID INT;
INSERT INTO ORDERS (OID,PNAME,PRICE,CID)
VALUES(105,'TV',10000,NULL);
--RIGHT JOIN
SELECT C.CID,CNAME,CITY,PHONE,OID,PNAME,PRICE FROM customers C
RIGHT JOIN ORDERS O
ON(C.cid = O.CID);
--CROSS JOIN
SELECT CNAME,PNAME FROM CUSTOMERS CROSS JOIN ORDERS;

--BETWEEN
SELECT PNAME,PRICE FROM ORDERS
WHERE PRICE BETWEEN 100 AND 2700;

--DISPLAY THE CUSTOMERS WHO HAVE PURCHASED PRODUCT OF MORE THAN 25000 RUPEES
SELECT CID,CNAME FROM CUSTOMERS
WHERE CID IN(
    SELECT CID FROM ORDERS WHERE PRICE>25000;
)

--DISPLAY THE CUSTOMERS WHO HAVE PURCHASED MORE THAN 1 PRODUCT
 SELECT CID,CNAME FROM CUSTOMERS
 WHERE CID IN(
	SELECT CID FROM ORDERS
	GROUP BY CID HAVING COUNT(CID)>1
);


